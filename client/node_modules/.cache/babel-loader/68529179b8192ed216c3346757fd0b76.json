{"ast":null,"code":"import { takeEvery, put, call } from 'redux-saga/effects';\nimport { axios } from '../../axios';\nimport { AUTONOTIFICATION } from '../action-types';\nimport { isAdmin, isLogin, userToken, userExpiresIn, userId } from '../actions/auth-actions';\nexport function* autonotificationWatcher() {\n  yield takeEvery(AUTONOTIFICATION, autonotificationWorker);\n}\n\nasync function autonotificationResp(action) {\n  const res = await axios.post('/auth/login', {\n    email: action.payload.email,\n    password: action.payload.password\n  });\n  return res;\n}\n\nfunction* autonotificationWorker(action) {\n  try {\n    const res = yield call(autonotificationResp, action);\n    yield put(isAdmin(res.data.admin));\n    yield put(isLogin(res.data.isLogin));\n    yield put(userToken(res.data.token));\n    yield put(userExpiresIn(res.data.expiresIn));\n    yield put(userId(res.data.userId));\n  } catch (e) {\n    throw e;\n  }\n}\n\nexport function* logoutMethodWatcher() {\n  yield takeEvery(AUTONOTIFICATION, logoutMethodWorker);\n}\n\nasync function logoutMethodResp(action) {\n  const res = await axios.put('/auth/logout', {\n    userId: action.payload.Id\n  });\n  return res;\n}\n\nfunction* logoutMethodWorker(action) {\n  try {\n    const res = yield call(logoutMethodResp, action);\n    yield put(isAdmin(false));\n    yield put(isLogin(false));\n    yield put(userToken(''));\n    yield put(userExpiresIn('0'));\n    yield put(userId(''));\n    localStorage.removeItem('isLogin');\n    localStorage.removeItem('token');\n    localStorage.removeItem('expiresIn');\n  } catch (e) {\n    throw e;\n  }\n}","map":{"version":3,"sources":["D:/проекты/React/Ionic-pizza/client/src/store/sagas/auth.ts"],"names":["takeEvery","put","call","axios","AUTONOTIFICATION","isAdmin","isLogin","userToken","userExpiresIn","userId","autonotificationWatcher","autonotificationWorker","autonotificationResp","action","res","post","email","payload","password","data","admin","token","expiresIn","e","logoutMethodWatcher","logoutMethodWorker","logoutMethodResp","Id","localStorage","removeItem"],"mappings":"AAAA,SAASA,SAAT,EAAoBC,GAApB,EAAyBC,IAAzB,QAAqC,oBAArC;AACA,SAASC,KAAT,QAAsB,aAAtB;AACA,SAASC,gBAAT,QAAiC,iBAAjC;AACA,SAASC,OAAT,EAAkBC,OAAlB,EAA2BC,SAA3B,EAAsCC,aAAtC,EAAqDC,MAArD,QAAmE,yBAAnE;AAEA,OAAO,UAAUC,uBAAV,GAAoC;AACvC,QAAMV,SAAS,CAACI,gBAAD,EAAmBO,sBAAnB,CAAf;AACH;;AAED,eAAeC,oBAAf,CAAoCC,MAApC,EAAiD;AAC7C,QAAMC,GAAG,GAAG,MAAMX,KAAK,CAACY,IAAN,CAAW,aAAX,EAA0B;AAAEC,IAAAA,KAAK,EAAEH,MAAM,CAACI,OAAP,CAAeD,KAAxB;AAA+BE,IAAAA,QAAQ,EAAEL,MAAM,CAACI,OAAP,CAAeC;AAAxD,GAA1B,CAAlB;AACA,SAAOJ,GAAP;AACH;;AAED,UAAUH,sBAAV,CAAiCE,MAAjC,EAA8C;AAC1C,MAAI;AACA,UAAMC,GAAG,GAAG,MAAMZ,IAAI,CAACU,oBAAD,EAA8BC,MAA9B,CAAtB;AACA,UAAMZ,GAAG,CAACI,OAAO,CAACS,GAAG,CAACK,IAAJ,CAASC,KAAV,CAAR,CAAT;AACA,UAAMnB,GAAG,CAACK,OAAO,CAACQ,GAAG,CAACK,IAAJ,CAASb,OAAV,CAAR,CAAT;AACA,UAAML,GAAG,CAACM,SAAS,CAACO,GAAG,CAACK,IAAJ,CAASE,KAAV,CAAV,CAAT;AACA,UAAMpB,GAAG,CAACO,aAAa,CAACM,GAAG,CAACK,IAAJ,CAASG,SAAV,CAAd,CAAT;AACA,UAAMrB,GAAG,CAACQ,MAAM,CAACK,GAAG,CAACK,IAAJ,CAASV,MAAV,CAAP,CAAT;AACH,GAPD,CAOE,OAAOc,CAAP,EAAU;AACR,UAAMA,CAAN;AACH;AACJ;;AAED,OAAO,UAAUC,mBAAV,GAAgC;AACnC,QAAMxB,SAAS,CAACI,gBAAD,EAAmBqB,kBAAnB,CAAf;AACH;;AAED,eAAeC,gBAAf,CAAgCb,MAAhC,EAA6C;AACzC,QAAMC,GAAG,GAAG,MAAMX,KAAK,CAACF,GAAN,CAAU,cAAV,EAA0B;AAAEQ,IAAAA,MAAM,EAAEI,MAAM,CAACI,OAAP,CAAeU;AAAzB,GAA1B,CAAlB;AACA,SAAOb,GAAP;AACH;;AAED,UAAUW,kBAAV,CAA6BZ,MAA7B,EAA0C;AACtC,MAAI;AACA,UAAMC,GAAG,GAAG,MAAMZ,IAAI,CAACwB,gBAAD,EAA0Bb,MAA1B,CAAtB;AACA,UAAMZ,GAAG,CAACI,OAAO,CAAC,KAAD,CAAR,CAAT;AACA,UAAMJ,GAAG,CAACK,OAAO,CAAC,KAAD,CAAR,CAAT;AACA,UAAML,GAAG,CAACM,SAAS,CAAC,EAAD,CAAV,CAAT;AACA,UAAMN,GAAG,CAACO,aAAa,CAAC,GAAD,CAAd,CAAT;AACA,UAAMP,GAAG,CAACQ,MAAM,CAAC,EAAD,CAAP,CAAT;AACAmB,IAAAA,YAAY,CAACC,UAAb,CAAwB,SAAxB;AACAD,IAAAA,YAAY,CAACC,UAAb,CAAwB,OAAxB;AACAD,IAAAA,YAAY,CAACC,UAAb,CAAwB,WAAxB;AACH,GAVD,CAUE,OAAON,CAAP,EAAU;AACR,UAAMA,CAAN;AACH;AACJ","sourcesContent":["import { takeEvery, put, call } from 'redux-saga/effects';\r\nimport { axios } from '../../axios';\r\nimport { AUTONOTIFICATION } from '../action-types';\r\nimport { isAdmin, isLogin, userToken, userExpiresIn, userId } from '../actions/auth-actions';\r\n\r\nexport function* autonotificationWatcher() {\r\n    yield takeEvery(AUTONOTIFICATION, autonotificationWorker);\r\n}\r\n\r\nasync function autonotificationResp(action: any) {\r\n    const res = await axios.post('/auth/login', { email: action.payload.email, password: action.payload.password });\r\n    return res;\r\n}\r\n\r\nfunction* autonotificationWorker(action: any) {\r\n    try {\r\n        const res = yield call(autonotificationResp as any, action);\r\n        yield put(isAdmin(res.data.admin));\r\n        yield put(isLogin(res.data.isLogin));\r\n        yield put(userToken(res.data.token));\r\n        yield put(userExpiresIn(res.data.expiresIn));\r\n        yield put(userId(res.data.userId));\r\n    } catch (e) {\r\n        throw e;\r\n    }\r\n}\r\n\r\nexport function* logoutMethodWatcher() {\r\n    yield takeEvery(AUTONOTIFICATION, logoutMethodWorker);\r\n}\r\n\r\nasync function logoutMethodResp(action: any) {\r\n    const res = await axios.put('/auth/logout', { userId: action.payload.Id });\r\n    return res;\r\n}\r\n\r\nfunction* logoutMethodWorker(action: any) {\r\n    try {\r\n        const res = yield call(logoutMethodResp as any, action);\r\n        yield put(isAdmin(false));\r\n        yield put(isLogin(false));\r\n        yield put(userToken(''));\r\n        yield put(userExpiresIn('0'));\r\n        yield put(userId(''));\r\n        localStorage.removeItem('isLogin');\r\n        localStorage.removeItem('token');\r\n        localStorage.removeItem('expiresIn');\r\n    } catch (e) {\r\n        throw e;\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}